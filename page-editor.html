<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü - WorldTravel</title>
    <link rel="stylesheet" href="admin-style.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', Arial, sans-serif; background: #f5f7fa; height: 100vh; overflow: hidden; }
        .editor-container { display: flex; height: 100vh; }
        .preview-panel { flex: 1; background: white; display: flex; flex-direction: column; }
        .editor-panel { width: 400px; background: white; border-left: 2px solid #e1e5e9; display: flex; flex-direction: column; }
        .panel-header { padding: 20px; background: #2c5aa0; color: white; }
        .preview-frame-container { flex: 1; position: relative; background: #f8f9fa; }
        .preview-frame { width: 100%; height: 100%; border: none; background: white; }
        .section-list { padding: 20px; flex: 1; overflow-y: auto; }
        .section-item { padding: 15px; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; margin-bottom: 10px; cursor: pointer; transition: all 0.3s ease; }
        .section-item:hover { border-color: #2c5aa0; background: #e3f2fd; }
        .section-title { font-weight: 600; margin-bottom: 5px; color: #333; }
        .section-desc { color: #666; font-size: 0.9em; }
        .btn { background: #28a745; color: white; padding: 12px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; margin: 5px; transition: background 0.3s; }
        .btn:hover { background: #218838; }
        .btn-secondary { background: #6c757d; }
        .btn-secondary:hover { background: #545b62; }
        .safe-badge { background: #dc3545; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8em; margin-left: 10px; }
    </style>
</head>
<body>
    <div class="editor-container">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
        <div class="preview-panel">
            <div class="panel-header">
                <h2 style="margin: 0 0 10px 0;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã <span class="safe-badge">BLOB SAFE</span></h2>
                <div>
                    <button class="btn btn-secondary" onclick="refreshPreview()">
                        –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                    <button class="btn" onclick="saveAndExit()">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤—ã–π—Ç–∏
                    </button>
                </div>
            </div>
            <div class="preview-frame-container">
                <iframe class="preview-frame" id="preview-frame" src="index-preview.html"></iframe>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - —Ä–µ–¥–∞–∫—Ç–æ—Ä -->
        <div class="editor-panel">
            <div class="panel-header">
                <h2 style="margin: 0;">–†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h2>
            </div>
            <div class="section-list">
                <div class="section-item" data-section="hero">
                    <div class="section-title">–ì–ª–∞–≤–Ω—ã–π –±–∞–Ω–Ω–µ—Ä</div>
                    <div class="section-desc">–ó–∞–≥–æ–ª–æ–≤–æ–∫, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
                </div>
                <div class="section-item" data-section="about">
                    <div class="section-title">–û –∫–æ–º–ø–∞–Ω–∏–∏</div>
                    <div class="section-desc">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                </div>
                <div class="section-item" data-section="services">
                    <div class="section-title">–£—Å–ª—É–≥–∏</div>
                    <div class="section-desc">–°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –∫–æ–º–ø–∞–Ω–∏–∏</div>
                </div>
                <div class="section-item" data-section="destinations">
                    <div class="section-title">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
                    <div class="section-desc">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
                </div>
                <div class="section-item" data-section="contact">
                    <div class="section-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
                    <div class="section-desc">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ë–ï–ó–û–ü–ê–°–ù–ê–Ø –í–ï–†–°–ò–Ø –†–ï–î–ê–ö–¢–û–†–ê - –ù–ò–ö–ê–ö–ò–• BLOB OPERATIONS
        console.log('üöÄ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            initEditor();
            setupSafeEnvironment();
        });
        
        function initEditor() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–µ–∫—Ü–∏–π
            var sections = document.querySelectorAll('.section-item');
            sections.forEach(function(section) {
                section.addEventListener('click', function() {
                    var sectionId = this.getAttribute('data-section');
                    selectSection(sectionId);
                });
            });
        }
        
        function setupSafeEnvironment() {
            // –ë–ª–æ–∫–∏—Ä—É–µ–º createObjectURL –≥–ª–æ–±–∞–ª—å–Ω–æ
            if (typeof URL !== 'undefined' && URL.createObjectURL) {
                var originalCreateObjectURL = URL.createObjectURL;
                URL.createObjectURL = function() {
                    console.warn('üö´ createObjectURL –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞');
                    return 'blob:blocked-by-editor';
                };
            }
            
            // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏ blob
            window.addEventListener('error', function(event) {
                if (event.target && event.target.src && event.target.src.includes('blob:')) {
                    console.warn('Blob error intercepted:', event.target.src);
                    event.preventDefault();
                    return false;
                }
            });
        }
        
        function selectSection(sectionId) {
            var sectionName = getSectionName(sectionId);
            showNotification('–í—ã–±—Ä–∞–Ω–∞ —Å–µ–∫—Ü–∏—è: ' + sectionName);
            
            // –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä - –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            setTimeout(function() {
                var content = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è —Å–µ–∫—Ü–∏–∏ "' + sectionName + '":', '–¢–µ–∫—Å—Ç —Å–µ–∫—Ü–∏–∏...');
                if (content !== null) {
                    showNotification('–¢–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è: ' + sectionName);
                    refreshPreview();
                }
            }, 100);
        }
        
        function getSectionName(sectionId) {
            var names = {
                'hero': '–ì–ª–∞–≤–Ω—ã–π –±–∞–Ω–Ω–µ—Ä',
                'about': '–û –∫–æ–º–ø–∞–Ω–∏–∏', 
                'services': '–£—Å–ª—É–≥–∏',
                'destinations': '–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è',
                'contact': '–ö–æ–Ω—Ç–∞–∫—Ç—ã'
            };
            return names[sectionId] || sectionId;
        }
        
        function refreshPreview() {
            var frame = document.getElementById('preview-frame');
            if (frame) {
                frame.src = frame.src; // –ü—Ä–æ—Å—Ç–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
                showNotification('–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –æ–±–Ω–æ–≤–ª–µ–Ω');
            }
        }
        
        function saveAndExit() {
            showNotification('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');
            setTimeout(function() {
                window.location.href = 'admin.html';
            }, 500);
        }
        
        function showNotification(message) {
            var notification = document.createElement('div');
            notification.style.cssText = [
                'position: fixed',
                'top: 20px',
                'right: 20px',
                'background: #28a745',
                'color: white',
                'padding: 15px 20px',
                'border-radius: 8px',
                'z-index: 10000',
                'font-size: 14px',
                'font-weight: 500',
                'box-shadow: 0 4px 12px rgba(0,0,0,0.15)',
                'animation: slideIn 0.3s ease'
            ].join(';');
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(function() {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
        var style = document.createElement('style');
        style.textContent = '@keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }';
        document.head.appendChild(style);
        
        console.log('‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ä–µ–¥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞');
    </script>
</body>
</html>
